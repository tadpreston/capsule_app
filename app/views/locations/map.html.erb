<div id="map-canvas" style="height: 500px; width: 100%;"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js">
</script>
<script type="text/javascript">
  var locations = <%= raw @locations.to_json.html_safe %>;
  $(document).ready(function(){
    initialize();
  });

  function initialize() {
    var myLatlng = new google.maps.LatLng(locations[0].latitude, locations[0].longitude);
    var mapOptions = {
    center: myLatlng,
    zoom: 8
  };
  var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

  locations.forEach(function(location){
    var thisLatLng = new google.maps.LatLng(location.latitude, location.longitude);
    var marker = new google.maps.Marker({
      position: thisLatLng,
      map: map,
      title:location.name,
      //animation: google.maps.Animation.DROP,
    });
    var infowindow = new google.maps.InfoWindow({
      content: location.name
    });

    google.maps.event.addListener(marker, 'click', function() {
      infowindow.open(map,marker);
    });
  });
}
</script>
